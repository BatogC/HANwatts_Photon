\section{lib/\+M\+F\+R\+C522/src/\+M\+F\+R\+C522.h File Reference}
\label{_m_f_r_c522_8h}\index{lib/\+M\+F\+R\+C522/src/\+M\+F\+R\+C522.\+h@{lib/\+M\+F\+R\+C522/src/\+M\+F\+R\+C522.\+h}}
{\ttfamily \#include \char`\"{}Particle.\+h\char`\"{}}\newline
Include dependency graph for M\+F\+R\+C522.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_m_f_r_c522_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_m_f_r_c522_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ M\+F\+R\+C522}
\item 
struct \textbf{ M\+F\+R\+C522\+::\+Uid}
\item 
struct \textbf{ M\+F\+R\+C522\+::\+M\+I\+F\+A\+R\+E\+\_\+\+Key}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef uint16\+\_\+t \textbf{ word}
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\mbox{\label{_m_f_r_c522_8h_aacc262b7acb8ef2b1d38df8b855bc0f6}} 
\index{M\+F\+R\+C522.\+h@{M\+F\+R\+C522.\+h}!word@{word}}
\index{word@{word}!M\+F\+R\+C522.\+h@{M\+F\+R\+C522.\+h}}
\subsubsection{word}
{\footnotesize\ttfamily typedef uint16\+\_\+t \textbf{ word}}

M\+F\+R\+C522.\+h -\/ Library to use A\+R\+D\+U\+I\+NO R\+F\+ID M\+O\+D\+U\+LE K\+IT 13.\+56 M\+HZ W\+I\+TH T\+A\+GS S\+PI W A\+ND R BY C\+O\+O\+Q\+R\+O\+B\+OT. Based on code Dr.\+Leong ( W\+W\+W.\+B2\+C\+Q\+S\+H\+O\+P.\+C\+OM ) Created by Miguel Balboa (circuitito.\+com), Jan, 2012. Rewritten by Søren Thing Andersen (access.\+thing.\+dk), fall of 2013 (Translation to English, refactored, comments, anti collision, cascade levels.) Released into the public domain.

Please read this file for an overview and then \doxyref{M\+F\+R\+C522.\+cpp}{p.}{_m_f_r_c522_8cpp} for comments on the specific functions. Search for \char`\"{}mf-\/rc522\char`\"{} on ebay.\+com to purchase the M\+F-\/\+R\+C522 board.

There are three hardware components involved\+: 1) The micro controller\+: An Arduino 2) The P\+CD (short for Proximity Coupling Device)\+: N\+XP \doxyref{M\+F\+R\+C522}{p.}{class_m_f_r_c522} Contactless Reader IC 3) The P\+I\+CC (short for Proximity Integrated Circuit Card)\+: A card or tag using the I\+SO 14443A interface, eg Mifare or N\+T\+A\+G203.

The microcontroller and card reader uses S\+PI for communication. The protocol is described in the \doxyref{M\+F\+R\+C522}{p.}{class_m_f_r_c522} datasheet\+: {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F\+R\+C522.\+pdf}

The card reader and the tags communicate using a 13.\+56\+M\+Hz electromagnetic field. The protocol is defined in I\+S\+O/\+I\+EC 14443-\/3 Identification cards -- Contactless integrated circuit cards -- Proximity cards -- Part 3\+: Initialization and anticollision". A free version of the final draft can be found at {\tt http\+://wg8.\+de/wg8n1496\+\_\+17n3613\+\_\+\+Ballot\+\_\+\+F\+C\+D14443-\/3.\+pdf} Details are found in chapter 6, Type A – Initialization and anticollision.

If only the P\+I\+CC U\+ID is wanted, the above documents has all the needed information. To read and write from M\+I\+F\+A\+RE P\+I\+C\+Cs, the M\+I\+F\+A\+RE protocol is used after the P\+I\+CC has been selected. The M\+I\+F\+A\+RE Classic chips and protocol is described in the datasheets\+: 1K\+: {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F1\+S503x.\+pdf} 4K\+: {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F1\+S703x.\+pdf} Mini\+: {\tt http\+://www.\+idcardmarket.\+com/download/mifare\+\_\+\+S20\+\_\+datasheet.\+pdf} The M\+I\+F\+A\+RE Ultralight chip and protocol is described in the datasheets\+: Ultralight\+: {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F0\+I\+C\+U1.\+pdf} Ultralight C\+: {\tt http\+://www.\+nxp.\+com/documents/short\+\_\+data\+\_\+sheet/\+M\+F0\+I\+C\+U2\+\_\+\+S\+D\+S.\+pdf}

M\+I\+F\+A\+RE Classic 1K (M\+F1\+S503x)\+: Has 16 sectors $\ast$ 4 blocks/sector $\ast$ 16 bytes/block = 1024 bytes. The blocks are numbered 0-\/63. Block 3 in each sector is the Sector Trailer. See {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F1\+S503x.\+pdf} sections 8.\+6 and 8.\+7\+: Bytes 0-\/5\+: Key A Bytes 6-\/8\+: Access Bits Bytes 9\+: User data Bytes 10-\/15\+: Key B (or user data) Block 0 is read only manufacturer data. To access a block, an authentication using a key from the block\textquotesingle{}s sector must be performed first. Example\+: To read from block 10, first authenticate using a key from sector 3 (blocks 8-\/11). All keys are set to F\+F\+F\+F\+F\+F\+F\+F\+F\+F\+F\+Fh at chip delivery. Warning\+: Please read section 8.\+7 \char`\"{}\+Memory Access\char`\"{}. It includes this text\+: if the P\+I\+CC detects a format violation the whole sector is irreversibly blocked. To use a block in \char`\"{}value block\char`\"{} mode (for Increment/\+Decrement operations) you need to change the sector trailer. Use P\+I\+C\+C\+\_\+\+Set\+Access\+Bits() to calculate the bit patterns. M\+I\+F\+A\+RE Classic 4K (M\+F1\+S703x)\+: Has (32 sectors $\ast$ 4 blocks/sector + 8 sectors $\ast$ 16 blocks/sector) $\ast$ 16 bytes/block = 4096 bytes. The blocks are numbered 0-\/255. The last block in each sector is the Sector Trailer like above. M\+I\+F\+A\+RE Classic Mini (M\+F1 IC S20)\+: Has 5 sectors $\ast$ 4 blocks/sector $\ast$ 16 bytes/block = 320 bytes. The blocks are numbered 0-\/19. The last block in each sector is the Sector Trailer like above.

M\+I\+F\+A\+RE Ultralight (M\+F0\+I\+C\+U1)\+: Has 16 pages of 4 bytes = 64 bytes. Pages 0 + 1 is used for the 7-\/byte U\+ID. Page 2 contains the last chech digit for the U\+ID, one byte manufacturer internal data, and the lock bytes (see {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F0\+I\+C\+U1.\+pdf} section 8.\+5.\+2) Page 3 is O\+TP, One Time Programmable bits. Once set to 1 they cannot revert to 0. Pages 4-\/15 are read/write unless blocked by the lock bytes in page 2. M\+I\+F\+A\+RE Ultralight C (M\+F0\+I\+C\+U2)\+: Has 48 pages of 4 bytes = 64 bytes. Pages 0 + 1 is used for the 7-\/byte U\+ID. Page 2 contains the last chech digit for the U\+ID, one byte manufacturer internal data, and the lock bytes (see {\tt http\+://www.\+nxp.\+com/documents/data\+\_\+sheet/\+M\+F0\+I\+C\+U1.\+pdf} section 8.\+5.\+2) Page 3 is O\+TP, One Time Programmable bits. Once set to 1 they cannot revert to 0. Pages 4-\/39 are read/write unless blocked by the lock bytes in page 2. Page 40 Lock bytes Page 41 16 bit one way counter Pages 42-\/43 Authentication configuration Pages 44-\/47 Authentication key 

Definition at line 83 of file M\+F\+R\+C522.\+h.

