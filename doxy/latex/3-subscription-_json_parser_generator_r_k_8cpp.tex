\section{lib/\+Json\+Parser\+Generator\+R\+K/examples/3-\/subscription/3-\/subscription-\/\+Json\+Parser\+Generator\+RK.cpp File Reference}
\label{3-subscription-_json_parser_generator_r_k_8cpp}\index{lib/\+Json\+Parser\+Generator\+R\+K/examples/3-\/subscription/3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{lib/\+Json\+Parser\+Generator\+R\+K/examples/3-\/subscription/3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
{\ttfamily \#include \char`\"{}Particle.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Json\+Parser\+Generator\+R\+K.\+h\char`\"{}}\newline
Include dependency graph for 3-\/subscription-\/\+Json\+Parser\+Generator\+RK.cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{3-subscription-_json_parser_generator_r_k_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ subscription\+Handler} (const char $\ast$event, const char $\ast$data)
\item 
void \textbf{ print\+Json} (\textbf{ Json\+Parser} \&jp)
\item 
void \textbf{ setup} ()
\item 
void \textbf{ loop} ()
\item 
void \textbf{ print\+Indent} (size\+\_\+t indent)
\item 
void \textbf{ print\+String} (const char $\ast$str)
\item 
void \textbf{ print\+Json\+Inner} (\textbf{ Json\+Parser} \&jp, const \textbf{ Json\+Parser\+Generator\+R\+K\+::jsmntok\+\_\+t} $\ast$container, size\+\_\+t indent)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\textbf{ Json\+Parser\+Static}$<$ 2048, 100 $>$ \textbf{ json\+Parser}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_afe461d27b9c48d5921c00d521181f12f}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!loop@{loop}}
\index{loop@{loop}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{loop()}
{\footnotesize\ttfamily void loop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 22 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.


\begin{DoxyCode}
22             \{
23 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_ae269cd10672ea800dd6fd6f14e48d0f8}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!print\+Indent@{print\+Indent}}
\index{print\+Indent@{print\+Indent}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{print\+Indent()}
{\footnotesize\ttfamily void print\+Indent (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{indent }\end{DoxyParamCaption})}



Definition at line 47 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.


\begin{DoxyCode}
47                                 \{
48     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} ii = 0; ii < 2 * indent; ii++) \{
49         Serial.printf(\textcolor{stringliteral}{" "});
50     \}
51 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_aa852eb9203676959147483523ec49997}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!print\+Json@{print\+Json}}
\index{print\+Json@{print\+Json}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{print\+Json()}
{\footnotesize\ttfamily void print\+Json (\begin{DoxyParamCaption}\item[{\textbf{ Json\+Parser} \&}]{jp }\end{DoxyParamCaption})}



Definition at line 149 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.



References Json\+Parser\+::get\+Outer\+Token(), and print\+Json\+Inner().


\begin{DoxyCode}
149                                \{
150     printJsonInner(jp, jp.getOuterToken(), 0);
151 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_a7a86f133587ae90abe048be568db828f}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!print\+Json\+Inner@{print\+Json\+Inner}}
\index{print\+Json\+Inner@{print\+Json\+Inner}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{print\+Json\+Inner()}
{\footnotesize\ttfamily void print\+Json\+Inner (\begin{DoxyParamCaption}\item[{\textbf{ Json\+Parser} \&}]{jp,  }\item[{const \textbf{ Json\+Parser\+Generator\+R\+K\+::jsmntok\+\_\+t} $\ast$}]{container,  }\item[{size\+\_\+t}]{indent }\end{DoxyParamCaption})}



Definition at line 75 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.



References Json\+Parser\+Generator\+R\+K\+::jsmntok\+\_\+t\+::end, Json\+Parser\+::get\+Key\+Value\+Token\+By\+Index(), Json\+Parser\+::get\+Token\+Value(), Json\+Parser\+::get\+Value\+Token\+By\+Index(), Json\+Parser\+Generator\+R\+K\+::\+J\+S\+M\+N\+\_\+\+A\+R\+R\+AY, Json\+Parser\+Generator\+R\+K\+::\+J\+S\+M\+N\+\_\+\+O\+B\+J\+E\+CT, Json\+Parser\+Generator\+R\+K\+::\+J\+S\+M\+N\+\_\+\+P\+R\+I\+M\+I\+T\+I\+VE, Json\+Parser\+Generator\+R\+K\+::\+J\+S\+M\+N\+\_\+\+S\+T\+R\+I\+NG, Json\+Parser\+Generator\+R\+K\+::\+J\+S\+M\+N\+\_\+\+U\+N\+D\+E\+F\+I\+N\+ED, print\+Indent(), print\+Json\+Inner(), print\+String(), Json\+Parser\+Generator\+R\+K\+::jsmntok\+\_\+t\+::start, and Json\+Parser\+Generator\+R\+K\+::jsmntok\+\_\+t\+::type.


\begin{DoxyCode}
75                                                                                                     \{
76 
77     \textcolor{keywordflow}{switch}(container->type) \{
78     \textcolor{keywordflow}{case} JsonParserGeneratorRK::JSMN_OBJECT: \{
79         printIndent(indent);
80         Serial.printf(\textcolor{stringliteral}{"\{\(\backslash\)n"});
81 
82         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} ii = 0; ; ii++) \{
83             \textcolor{keyword}{const} JsonParserGeneratorRK::jsmntok_t *keyToken;
84             \textcolor{keyword}{const} JsonParserGeneratorRK::jsmntok_t *valueToken;
85 
86             \textcolor{keywordflow}{if} (!jp.getKeyValueTokenByIndex(container, keyToken, valueToken, ii)) \{
87                 \textcolor{keywordflow}{break};
88             \}
89             \textcolor{keywordflow}{if} (ii > 0) \{
90                 Serial.printf(\textcolor{stringliteral}{",\(\backslash\)n"});
91             \}
92 
93             String keyName;
94             jp.getTokenValue(keyToken, keyName);
95 
96             printIndent(indent + 1);
97             printString(keyName);
98             Serial.printf(\textcolor{stringliteral}{":"});
99             printJsonInner(jp, valueToken, indent + 1);
100         \}
101         Serial.printf(\textcolor{stringliteral}{"\(\backslash\)n"});
102         printIndent(indent);
103         Serial.printf(\textcolor{stringliteral}{"\}\(\backslash\)n"});
104         \textcolor{keywordflow}{break};
105     \}
106     \textcolor{keywordflow}{case} JsonParserGeneratorRK::JSMN_ARRAY: \{
107         printIndent(indent);
108         Serial.printf(\textcolor{stringliteral}{"[\(\backslash\)n"});
109 
110         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} ii = 0; ; ii++) \{
111             \textcolor{keyword}{const} JsonParserGeneratorRK::jsmntok_t *valueToken;
112 
113             \textcolor{keywordflow}{if} (!jp.getValueTokenByIndex(container, ii, valueToken)) \{
114                 \textcolor{keywordflow}{break};
115             \}
116             \textcolor{keywordflow}{if} (ii > 0) \{
117                 Serial.printf(\textcolor{stringliteral}{",\(\backslash\)n"});
118             \}
119             printIndent(indent + 1);
120             printJsonInner(jp, valueToken, indent + 1);
121         \}
122         Serial.printf(\textcolor{stringliteral}{"\(\backslash\)n"});
123         printIndent(indent);
124         Serial.printf(\textcolor{stringliteral}{"]\(\backslash\)n"});
125         \textcolor{keywordflow}{break};
126     \}
127     \textcolor{keywordflow}{case} JsonParserGeneratorRK::JSMN_STRING: \{
128         Serial.printf(\textcolor{stringliteral}{"\(\backslash\)""});
129         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii = container->start; ii < container->end; ii++) \{
130             Serial.printf(\textcolor{stringliteral}{"%c"}, jp.getBuffer()[ii]);
131         \}
132         Serial.printf(\textcolor{stringliteral}{"\(\backslash\)""});
133         \textcolor{keywordflow}{break};
134     \}
135     \textcolor{keywordflow}{case} JsonParserGeneratorRK::JSMN_PRIMITIVE: \{
136         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii = container->start; ii < container->end; ii++) \{
137             Serial.printf(\textcolor{stringliteral}{"%c"}, jp.getBuffer()[ii]);
138         \}
139         \textcolor{keywordflow}{break};
140     \}
141     \textcolor{keywordflow}{case} JsonParserGeneratorRK::JSMN_UNDEFINED:
142     \textcolor{keywordflow}{default}: \{
143         \textcolor{keywordflow}{break};
144     \}
145     \}
146 
147 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_abe6d5621640c26d89a09be56928cd923}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!print\+String@{print\+String}}
\index{print\+String@{print\+String}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{print\+String()}
{\footnotesize\ttfamily void print\+String (\begin{DoxyParamCaption}\item[{const char $\ast$}]{str }\end{DoxyParamCaption})}



Definition at line 53 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.


\begin{DoxyCode}
53                                   \{
54     Serial.printf(\textcolor{stringliteral}{"\(\backslash\)""});
55 
56     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} ii = 0; str[ii]; ii++) \{
57         \textcolor{keywordflow}{if} (str[ii] == \textcolor{charliteral}{'"'}) \{
58             Serial.printf(\textcolor{stringliteral}{"\(\backslash\)\(\backslash\)\(\backslash\)""});
59         \}
60         \textcolor{keywordflow}{else}
61         \textcolor{keywordflow}{if} (str[ii] == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}) \{
62             Serial.printf(\textcolor{stringliteral}{"\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)"});
63         \}
64         \textcolor{keywordflow}{else}
65         \textcolor{keywordflow}{if} (str[ii] >= 32 && str[ii] < 127) \{
66             Serial.printf(\textcolor{stringliteral}{"%c"}, str[ii]);
67         \}
68         \textcolor{keywordflow}{else} \{
69             Serial.printf(\textcolor{stringliteral}{"\(\backslash\)\(\backslash\)x%02x"}, str[ii]);
70         \}
71     \}
72     Serial.printf(\textcolor{stringliteral}{"\(\backslash\)""});
73 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_a4fc01d736fe50cf5b977f755b675f11d}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!setup@{setup}}
\index{setup@{setup}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{setup()}
{\footnotesize\ttfamily void setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 17 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.


\begin{DoxyCode}
17              \{
18     Serial.begin(9600);
19     Particle.subscribe(\textcolor{stringliteral}{"jsonParserTest"}, subscriptionHandler, MY\_DEVICES);
20 \}
\end{DoxyCode}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_aa0bcca6652c4f60cb6e9bd893484650b}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!subscription\+Handler@{subscription\+Handler}}
\index{subscription\+Handler@{subscription\+Handler}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{subscription\+Handler()}
{\footnotesize\ttfamily void subscription\+Handler (\begin{DoxyParamCaption}\item[{const char $\ast$}]{event,  }\item[{const char $\ast$}]{data }\end{DoxyParamCaption})}



Definition at line 25 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.



References Json\+Buffer\+::add\+String(), Json\+Buffer\+::clear(), json\+Parser, Json\+Parser\+::parse(), and print\+Json().


\begin{DoxyCode}
25                                                               \{
26     \textcolor{keywordtype}{int} responseIndex = 0;
27 
28     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *slashOffset = strrchr(event, \textcolor{charliteral}{'/'});
29     \textcolor{keywordflow}{if} (slashOffset) \{
30         responseIndex = atoi(slashOffset + 1);
31     \}
32 
33     \textcolor{keywordflow}{if} (responseIndex == 0) \{
34         jsonParser.clear();
35     \}
36     jsonParser.addString(data);
37 
38     \textcolor{keywordflow}{if} (jsonParser.parse()) \{
39         \textcolor{comment}{// Looks valid (we received all parts)}
40 
41         \textcolor{comment}{// This printing thing is just for testing purposes, you should use the commands to}
42         \textcolor{comment}{// process data}
43         printJson(jsonParser);
44     \}
45 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\label{3-subscription-_json_parser_generator_r_k_8cpp_af1c065455ff8e2f533af5dd925c8469d}} 
\index{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}!json\+Parser@{json\+Parser}}
\index{json\+Parser@{json\+Parser}!3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp@{3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp}}
\subsubsection{json\+Parser}
{\footnotesize\ttfamily \textbf{ Json\+Parser\+Static}$<$2048, 100$>$ json\+Parser}



Definition at line 9 of file 3-\/subscription-\/\+Json\+Parser\+Generator\+R\+K.\+cpp.



Referenced by subscription\+Handler().

