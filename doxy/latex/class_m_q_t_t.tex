\section{M\+Q\+TT Class Reference}
\label{class_m_q_t_t}\index{M\+Q\+TT@{M\+Q\+TT}}


{\ttfamily \#include $<$M\+Q\+T\+T.\+h$>$}



Collaboration diagram for M\+Q\+TT\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=137pt]{class_m_q_t_t__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} \{ \textbf{ Q\+O\+S0} = 0, 
\textbf{ Q\+O\+S1} = 1, 
\textbf{ Q\+O\+S2} = 2
 \}
\item 
enum \textbf{ M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON} \{ \textbf{ M\+Q\+T\+T\+\_\+\+V31} = 3, 
\textbf{ M\+Q\+T\+T\+\_\+\+V311} = 4
 \}
\item 
enum \textbf{ E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE} \{ \newline
\textbf{ C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT} = 0, 
\textbf{ C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL} = 1, 
\textbf{ C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT} = 2, 
\textbf{ C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE} = 3, 
\newline
\textbf{ C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD} = 4, 
\textbf{ C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED} = 5
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ M\+Q\+TT} ()
\item 
\textbf{ M\+Q\+TT} (char $\ast$\textbf{ domain}, uint16\+\_\+t \textbf{ port}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int))
\item 
\textbf{ M\+Q\+TT} (char $\ast$\textbf{ domain}, uint16\+\_\+t \textbf{ port}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int), int \textbf{ maxpacketsize})
\item 
\textbf{ M\+Q\+TT} (uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int))
\item 
\textbf{ M\+Q\+TT} (uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int), int \textbf{ maxpacketsize})
\item 
\textbf{ M\+Q\+TT} (char $\ast$\textbf{ domain}, uint16\+\_\+t \textbf{ port}, int \textbf{ keepalive}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int))
\item 
\textbf{ M\+Q\+TT} (char $\ast$\textbf{ domain}, uint16\+\_\+t \textbf{ port}, int \textbf{ keepalive}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int), int \textbf{ maxpacketsize})
\item 
\textbf{ M\+Q\+TT} (uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port}, int \textbf{ keepalive}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int))
\item 
\textbf{ M\+Q\+TT} (uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port}, int \textbf{ keepalive}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int), int \textbf{ maxpacketsize})
\item 
\textbf{ $\sim$\+M\+Q\+TT} ()
\item 
void \textbf{ set\+Broker} (char $\ast$\textbf{ domain}, uint16\+\_\+t \textbf{ port})
\item 
void \textbf{ set\+Broker} (uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port})
\item 
bool \textbf{ connect} (const char $\ast$id)
\item 
bool \textbf{ connect} (const char $\ast$id, const char $\ast$user, const char $\ast$pass)
\item 
bool \textbf{ connect} (const char $\ast$id, const char $\ast$user, const char $\ast$pass, const char $\ast$will\+Topic, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} will\+Qos, uint8\+\_\+t will\+Retain, const char $\ast$will\+Message, bool clean\+Session, \textbf{ M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON} version=\textbf{ M\+Q\+T\+T\+\_\+\+V311})
\item 
void \textbf{ disconnect} ()
\item 
void \textbf{ clear} ()
\item 
bool \textbf{ publish} (const char $\ast$topic, const char $\ast$payload)
\item 
bool \textbf{ publish} (const char $\ast$topic, const char $\ast$payload, bool retain)
\item 
bool \textbf{ publish} (const char $\ast$topic, const char $\ast$payload, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, uint16\+\_\+t $\ast$messageid=N\+U\+LL)
\item 
bool \textbf{ publish} (const char $\ast$topic, const char $\ast$payload, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, bool dup, uint16\+\_\+t $\ast$messageid=N\+U\+LL)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$pyaload, unsigned int plength)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$payload, unsigned int plength, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, uint16\+\_\+t $\ast$messageid=N\+U\+LL)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$payload, unsigned int plength, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, bool dup, uint16\+\_\+t $\ast$messageid=N\+U\+LL)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$payload, unsigned int plength, bool retain)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$payload, unsigned int plength, bool retain, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, uint16\+\_\+t $\ast$messageid=N\+U\+LL)
\item 
bool \textbf{ publish} (const char $\ast$topic, const uint8\+\_\+t $\ast$payload, unsigned int plength, bool retain, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS} qos, bool dup, uint16\+\_\+t $\ast$messageid)
\item 
void \textbf{ add\+Qos\+Callback} (void($\ast$\textbf{ qoscallback})(unsigned int))
\item 
bool \textbf{ subscribe} (const char $\ast$topic)
\item 
bool \textbf{ subscribe} (const char $\ast$topic, \textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS})
\item 
bool \textbf{ unsubscribe} (const char $\ast$topic)
\item 
bool \textbf{ loop} ()
\item 
bool \textbf{ is\+Connected} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \textbf{ read\+Packet} (uint8\+\_\+t $\ast$)
\item 
uint8\+\_\+t \textbf{ read\+Byte} ()
\item 
bool \textbf{ write} (uint8\+\_\+t header, uint8\+\_\+t $\ast$buf, uint16\+\_\+t length)
\item 
uint16\+\_\+t \textbf{ write\+String} (const char $\ast$string, uint8\+\_\+t $\ast$buf, uint16\+\_\+t pos)
\item 
void \textbf{ initialize} (char $\ast$\textbf{ domain}, uint8\+\_\+t $\ast$\textbf{ ip}, uint16\+\_\+t \textbf{ port}, int \textbf{ keepalive}, void($\ast$\textbf{ callback})(char $\ast$, uint8\+\_\+t $\ast$, unsigned int), int \textbf{ maxpacketsize})
\item 
bool \textbf{ publish\+Release} (uint16\+\_\+t messageid)
\item 
bool \textbf{ publish\+Complete} (uint16\+\_\+t messageid)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
T\+C\+P\+Client \textbf{ \+\_\+client}
\item 
uint8\+\_\+t $\ast$ \textbf{ buffer} = N\+U\+LL
\item 
uint16\+\_\+t \textbf{ next\+Msg\+Id}
\item 
unsigned long \textbf{ last\+Out\+Activity}
\item 
unsigned long \textbf{ last\+In\+Activity}
\item 
bool \textbf{ ping\+Outstanding}
\item 
void($\ast$ \textbf{ callback} )(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)
\item 
void($\ast$ \textbf{ qoscallback} )(unsigned int)
\item 
\textbf{ String} \textbf{ domain}
\item 
uint8\+\_\+t $\ast$ \textbf{ ip} = N\+U\+LL
\item 
uint16\+\_\+t \textbf{ port}
\item 
int \textbf{ keepalive}
\item 
uint16\+\_\+t \textbf{ maxpacketsize}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 105 of file M\+Q\+T\+T.\+h.



\subsection{Member Enumeration Documentation}
\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bc}} 
\index{M\+Q\+TT@{M\+Q\+TT}!E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE@{E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE}}
\index{E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE@{E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE}
{\footnotesize\ttfamily enum \textbf{ M\+Q\+T\+T\+::\+E\+M\+Q\+T\+T\+\_\+\+C\+O\+N\+N\+A\+C\+K\+\_\+\+R\+E\+S\+P\+O\+N\+SE}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT@{C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT@{C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bca10b54b970868dd657f962f3e0211c51a}} 
C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL@{C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL@{C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bcab926be43cd794bcff8effaca0e3df5a2}} 
C\+O\+N\+N\+\_\+\+U\+N\+A\+C\+C\+E\+P\+T\+A\+B\+L\+E\+\_\+\+P\+R\+O\+C\+O\+T\+OL&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT@{C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT@{C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bcadfea79ffb19345af8eec727a2fab5ba7}} 
C\+O\+N\+N\+\_\+\+I\+D\+\_\+\+R\+E\+J\+E\+CT&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE@{C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE@{C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bca3f3bbddc59683ce074489bdba3479314}} 
C\+O\+N\+N\+\_\+\+S\+E\+R\+V\+E\+R\+\_\+\+U\+N\+A\+V\+A\+I\+L\+A\+LE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD@{C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD@{C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bcaa51f8337e0cd58337a6d9de028f7ffc5}} 
C\+O\+N\+N\+\_\+\+B\+A\+D\+\_\+\+U\+S\+E\+R\+\_\+\+P\+A\+S\+S\+W\+O\+RD&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED@{C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED@{C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED}}}\mbox{\label{class_m_q_t_t_a83c67833cdf6dfead0d42e6b48dae8bca2a9953af7d955ad4954e9836a03ee4fa}} 
C\+O\+N\+N\+\_\+\+N\+O\+T\+\_\+\+A\+U\+T\+H\+O\+R\+I\+Z\+ED&\\
\hline

\end{DoxyEnumFields}


Definition at line 119 of file M\+Q\+T\+T.\+h.


\begin{DoxyCode}
119              \{
120     CONN_ACCEPT = 0,
121     CONN_UNACCEPTABLE_PROCOTOL = 1,
122     CONN_ID_REJECT = 2,
123     CONN_SERVER_UNAVAILALE = 3,
124     CONN_BAD_USER_PASSWORD = 4,
125     CONN_NOT_AUTHORIZED = 5
126 \} EMQTT_CONNACK_RESPONSE;
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_aff501e08e20ebf26b3272fcc0e7215ff}} 
\index{M\+Q\+TT@{M\+Q\+TT}!E\+M\+Q\+T\+T\+\_\+\+Q\+OS@{E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}
\index{E\+M\+Q\+T\+T\+\_\+\+Q\+OS@{E\+M\+Q\+T\+T\+\_\+\+Q\+OS}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{E\+M\+Q\+T\+T\+\_\+\+Q\+OS}
{\footnotesize\ttfamily enum \textbf{ M\+Q\+T\+T\+::\+E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}

types \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{Q\+O\+S0@{Q\+O\+S0}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!Q\+O\+S0@{Q\+O\+S0}}}\mbox{\label{class_m_q_t_t_aff501e08e20ebf26b3272fcc0e7215ffa14dc14f3d6013dcbfb6a2d88f9245b81}} 
Q\+O\+S0&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Q\+O\+S1@{Q\+O\+S1}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!Q\+O\+S1@{Q\+O\+S1}}}\mbox{\label{class_m_q_t_t_aff501e08e20ebf26b3272fcc0e7215ffa67190ba35b18fa3bcdc3b1c34256b8f7}} 
Q\+O\+S1&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Q\+O\+S2@{Q\+O\+S2}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!Q\+O\+S2@{Q\+O\+S2}}}\mbox{\label{class_m_q_t_t_aff501e08e20ebf26b3272fcc0e7215ffa824da0ec0c31a8d2978980a4ac9f7eb2}} 
Q\+O\+S2&\\
\hline

\end{DoxyEnumFields}


Definition at line 108 of file M\+Q\+T\+T.\+h.


\begin{DoxyCode}
108              \{
109     QOS0 = 0,
110     QOS1 = 1,
111     QOS2 = 2,
112 \} EMQTT_QOS;
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a49430c9d6f68bbdc4e1bd039a6f5f97e}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON@{M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON}}
\index{M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON@{M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON}
{\footnotesize\ttfamily enum \textbf{ M\+Q\+T\+T\+::\+M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+V31@{M\+Q\+T\+T\+\_\+\+V31}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+T\+T\+\_\+\+V31@{M\+Q\+T\+T\+\_\+\+V31}}}\mbox{\label{class_m_q_t_t_a49430c9d6f68bbdc4e1bd039a6f5f97eaf955bab848df0e287c12f20b3af37885}} 
M\+Q\+T\+T\+\_\+\+V31&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+V311@{M\+Q\+T\+T\+\_\+\+V311}!M\+Q\+TT@{M\+Q\+TT}}\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+T\+T\+\_\+\+V311@{M\+Q\+T\+T\+\_\+\+V311}}}\mbox{\label{class_m_q_t_t_a49430c9d6f68bbdc4e1bd039a6f5f97eae61f66bbb0b315cf4cb7636684c68602}} 
M\+Q\+T\+T\+\_\+\+V311&\\
\hline

\end{DoxyEnumFields}


Definition at line 114 of file M\+Q\+T\+T.\+h.


\begin{DoxyCode}
114             \{
115     MQTT_V31 = 3,
116     MQTT_V311 = 4
117 \} MQTT_VERSION;
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\mbox{\label{class_m_q_t_t_a75b5fb0489a6ecc75d75ed2362e60aef}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [1/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 152 of file M\+Q\+T\+T.\+h.


\begin{DoxyCode}
152 \{\};
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a2ef4121d54530e1ffc918f2b0e3cbdc4}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [2/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint16\+\_\+t}]{port,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback }\end{DoxyParamCaption})}



Definition at line 12 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
12                                                                                      \{
13     this->initialize(domain, NULL, port, MQTT_DEFAULT_KEEPALIVE, callback, 
      MQTT_MAX_PACKET_SIZE);
14 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a95dc3446cd91fd3448c3fe3938a40f72}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [3/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint16\+\_\+t}]{port,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback,  }\item[{int}]{maxpacketsize }\end{DoxyParamCaption})}



Definition at line 16 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
16                                                                                                         \{
17     this->initialize(domain, NULL, port, MQTT_DEFAULT_KEEPALIVE, callback, 
      maxpacketsize);
18 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a0e4560eca8b493628aed67f949b45d42}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [4/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback }\end{DoxyParamCaption})}



Definition at line 20 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
20                                                                                     \{
21     this->initialize(NULL, ip, port, MQTT_DEFAULT_KEEPALIVE, callback, 
      MQTT_MAX_PACKET_SIZE);
22 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a39e00a946c41fbe9eb504577269569cc}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [5/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback,  }\item[{int}]{maxpacketsize }\end{DoxyParamCaption})}



Definition at line 24 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
24                                                                                                        \{
25     this->initialize(NULL, ip, port, MQTT_DEFAULT_KEEPALIVE, callback, 
      maxpacketsize);
26 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a799fede50157a7573f43582ccd429b5e}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [6/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint16\+\_\+t}]{port,  }\item[{int}]{keepalive,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback }\end{DoxyParamCaption})}



Definition at line 28 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
28                                                                                                     \{
29     this->initialize(domain, NULL, port, keepalive, callback, 
      MQTT_MAX_PACKET_SIZE);
30 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a418f1aaefd9ebb233358a532d82d2307}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [7/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint16\+\_\+t}]{port,  }\item[{int}]{keepalive,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback,  }\item[{int}]{maxpacketsize }\end{DoxyParamCaption})}



Definition at line 32 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
32                                                                                                            
                  \{
33     this->initialize(domain, NULL, port, keepalive, callback, maxpacketsize);
34 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ad68f2a18a197fa8944e8cc8e1950af5a}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [8/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port,  }\item[{int}]{keepalive,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback }\end{DoxyParamCaption})}



Definition at line 36 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
36                                                                                                    \{
37     this->initialize(NULL, ip, port, keepalive, callback, MQTT_MAX_PACKET_SIZE);
38 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a86aa31266ec2193bdd166e9fcd8c9d79}} 
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\index{M\+Q\+TT@{M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{M\+Q\+T\+T()\hspace{0.1cm}{\footnotesize\ttfamily [9/9]}}
{\footnotesize\ttfamily M\+Q\+T\+T\+::\+M\+Q\+TT (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port,  }\item[{int}]{keepalive,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback,  }\item[{int}]{maxpacketsize }\end{DoxyParamCaption})}



Definition at line 40 of file M\+Q\+T\+T.\+cpp.



References initialize().


\begin{DoxyCode}
40                                                                                                            
                 \{
41     this->initialize(NULL, ip, port, keepalive, callback, maxpacketsize);
42 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a07b8f99719144b5d3bc8d8d817de3e8e}} 
\index{M\+Q\+TT@{M\+Q\+TT}!````~M\+Q\+TT@{$\sim$\+M\+Q\+TT}}
\index{````~M\+Q\+TT@{$\sim$\+M\+Q\+TT}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{$\sim$\+M\+Q\+T\+T()}
{\footnotesize\ttfamily M\+Q\+T\+T\+::$\sim$\+M\+Q\+TT (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 44 of file M\+Q\+T\+T.\+cpp.



References buffer, disconnect(), and is\+Connected().


\begin{DoxyCode}
44             \{
45     \textcolor{keywordflow}{if} (isConnected()) \{
46         disconnect();
47     \}
48 
49     \textcolor{keywordflow}{if} (buffer != NULL)
50       \textcolor{keyword}{delete}[] buffer;
51 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\label{class_m_q_t_t_a324c79ef8a1bfaf03d7b3e73b957283b}} 
\index{M\+Q\+TT@{M\+Q\+TT}!add\+Qos\+Callback@{add\+Qos\+Callback}}
\index{add\+Qos\+Callback@{add\+Qos\+Callback}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{add\+Qos\+Callback()}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::add\+Qos\+Callback (\begin{DoxyParamCaption}\item[{void($\ast$)(unsigned int)}]{qoscallback }\end{DoxyParamCaption})}



Definition at line 89 of file M\+Q\+T\+T.\+cpp.



References qoscallback.


\begin{DoxyCode}
89                                                            \{
90     this->qoscallback = qoscallback;
91 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a510932d1c5fb0c918debcf60cfc267e1}} 
\index{M\+Q\+TT@{M\+Q\+TT}!clear@{clear}}
\index{clear@{clear}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{clear()}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 534 of file M\+Q\+T\+T.\+cpp.


\begin{DoxyCode}
534                  \{
535   _client.stop();
536   lastInActivity = lastOutActivity = millis();
537 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ae76d538b01191df33610a950bf4e9717}} 
\index{M\+Q\+TT@{M\+Q\+TT}!connect@{connect}}
\index{connect@{connect}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{connect()\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::connect (\begin{DoxyParamCaption}\item[{const char $\ast$}]{id }\end{DoxyParamCaption})}



Definition at line 94 of file M\+Q\+T\+T.\+cpp.



References connect(), and Q\+O\+S0.


\begin{DoxyCode}
94                                  \{
95     \textcolor{keywordflow}{return} connect(\textcolor{keywordtype}{id}, NULL, NULL, 0, QOS0, 0, 0, \textcolor{keyword}{true});
96 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a280e592fced51964607c66f7ab450b46}} 
\index{M\+Q\+TT@{M\+Q\+TT}!connect@{connect}}
\index{connect@{connect}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{connect()\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::connect (\begin{DoxyParamCaption}\item[{const char $\ast$}]{id,  }\item[{const char $\ast$}]{user,  }\item[{const char $\ast$}]{pass }\end{DoxyParamCaption})}



Definition at line 98 of file M\+Q\+T\+T.\+cpp.



References connect(), and Q\+O\+S0.


\begin{DoxyCode}
98                                                                      \{
99     \textcolor{keywordflow}{return} connect(\textcolor{keywordtype}{id}, user, pass, 0, QOS0, 0, 0, \textcolor{keyword}{true});
100 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_aa880316318b5bdc133c2f8c6bba1e253}} 
\index{M\+Q\+TT@{M\+Q\+TT}!connect@{connect}}
\index{connect@{connect}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{connect()\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::connect (\begin{DoxyParamCaption}\item[{const char $\ast$}]{id,  }\item[{const char $\ast$}]{user,  }\item[{const char $\ast$}]{pass,  }\item[{const char $\ast$}]{will\+Topic,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{will\+Qos,  }\item[{uint8\+\_\+t}]{will\+Retain,  }\item[{const char $\ast$}]{will\+Message,  }\item[{bool}]{clean\+Session,  }\item[{\textbf{ M\+Q\+T\+T\+\_\+\+V\+E\+R\+S\+I\+ON}}]{version = {\ttfamily \textbf{ M\+Q\+T\+T\+\_\+\+V311}} }\end{DoxyParamCaption})}



Definition at line 102 of file M\+Q\+T\+T.\+cpp.



References buffer, C\+O\+N\+N\+\_\+\+A\+C\+C\+E\+PT, is\+Connected(), keepalive, M\+Q\+T\+T\+\_\+\+V31, M\+Q\+T\+T\+\_\+\+V311, next\+Msg\+Id, ping\+Outstanding, read\+Packet(), write(), and write\+String().



Referenced by connect().


\begin{DoxyCode}
102                                                                                                            
                                                                                                \{
103     \textcolor{keywordflow}{if} (!isConnected()) \{
104         \textcolor{keywordtype}{int} result = 0;
105         \textcolor{keywordflow}{if} (ip == NULL)
106             result = _client.connect(this->domain.c_str(), this->port);
107         \textcolor{keywordflow}{else}
108             result = _client.connect(this->ip, this->port);
109 
110         \textcolor{keywordflow}{if} (result) \{
111             nextMsgId = 1;
112             uint16\_t length = 5;
113 
114             \textcolor{keywordflow}{if} (version == MQTT_V311) \{
115                 \textcolor{keyword}{const} uint8\_t MQTT\_HEADER\_V311[] = \{0x00,0x04,\textcolor{charliteral}{'M'},\textcolor{charliteral}{'Q'},\textcolor{charliteral}{'T'},\textcolor{charliteral}{'T'},
      MQTT_V311\};
116                 memcpy(buffer + length, MQTT\_HEADER\_V311, \textcolor{keyword}{sizeof}(MQTT\_HEADER\_V311));
117                 length+=\textcolor{keyword}{sizeof}(MQTT\_HEADER\_V311);
118             \} \textcolor{keywordflow}{else} \{
119                 \textcolor{keyword}{const} uint8\_t MQTT\_HEADER\_V31[] = \{0x00,0x06,\textcolor{charliteral}{'M'},\textcolor{charliteral}{'Q'},\textcolor{charliteral}{'I'},\textcolor{charliteral}{'s'},\textcolor{charliteral}{'d'},\textcolor{charliteral}{'p'}, 
      MQTT_V31\};
120                 memcpy(buffer + length, MQTT\_HEADER\_V31, \textcolor{keyword}{sizeof}(MQTT\_HEADER\_V31));
121                 length+=\textcolor{keyword}{sizeof}(MQTT\_HEADER\_V31);
122             \}
123 
124             uint8\_t v = 0;
125             \textcolor{keywordflow}{if} (willTopic) \{
126                 v = 0x06|(willQos<<3)|(willRetain<<5);
127             \} \textcolor{keywordflow}{else} \{
128                 v = 0x02;
129             \}
130 
131             \textcolor{keywordflow}{if} (!cleanSession) \{
132               v = v&0xfd;
133             \}
134 
135             \textcolor{keywordflow}{if}(user != NULL) \{
136                 v = v|0x80;
137 
138                 \textcolor{keywordflow}{if}(pass != NULL) \{
139                     v = v|(0x80>>1);
140                 \}
141             \}
142 
143             buffer[length++] = v;
144 
145             buffer[length++] = ((this->keepalive) >> 8);
146             buffer[length++] = ((this->keepalive) & 0xFF);
147             length = writeString(\textcolor{keywordtype}{id}, buffer, length);
148             \textcolor{keywordflow}{if} (willTopic) \{
149                 length = writeString(willTopic, buffer, length);
150                 length = writeString(willMessage, buffer, length);
151             \}
152 
153             \textcolor{keywordflow}{if}(user != NULL) \{
154                 length = writeString(user,buffer,length);
155                 \textcolor{keywordflow}{if}(pass != NULL) \{
156                     length = writeString(pass,buffer,length);
157                 \}
158             \}
159 
160             write(MQTTCONNECT, buffer, length-5);
161             lastInActivity = lastOutActivity = millis();
162 
163             \textcolor{keywordflow}{while} (!_client.available()) \{
164                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} t = millis();
165                 \textcolor{keywordflow}{if} (t-lastInActivity > this->keepalive*1000UL) \{
166                     _client.stop();
167                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
168                 \}
169             \}
170             uint8\_t llen;
171             uint16\_t len = readPacket(&llen);
172 
173             \textcolor{keywordflow}{if} (len == 4) \{
174                 \textcolor{keywordflow}{if} (buffer[3] == CONN_ACCEPT) \{
175                     lastInActivity = millis();
176                     pingOutstanding = \textcolor{keyword}{false};
177                     debug_print(\textcolor{stringliteral}{" Connect success\(\backslash\)n"});
178                     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
179                 \} \textcolor{keywordflow}{else} \{
180                     \textcolor{comment}{// check EMQTT\_CONNACK\_RESPONSE code.}
181                     debug_print(\textcolor{stringliteral}{" Connect fail. code = [%d]\(\backslash\)n"}, buffer[3]);
182                 \}
183             \}
184         \}
185         _client.stop();
186     \}
187     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
188 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a7d49b425517408d227836c10169f8df8}} 
\index{M\+Q\+TT@{M\+Q\+TT}!disconnect@{disconnect}}
\index{disconnect@{disconnect}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{disconnect()}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::disconnect (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 506 of file M\+Q\+T\+T.\+cpp.



References buffer.



Referenced by set\+Broker(), and $\sim$\+M\+Q\+T\+T().


\begin{DoxyCode}
506                       \{
507     buffer[0] = MQTTDISCONNECT;
508     buffer[1] = 0;
509     _client.write(buffer,2);
510     _client.stop();
511     lastInActivity = lastOutActivity = millis();
512 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a849de76aa2a1f4b89c1b4a8dfb7c3661}} 
\index{M\+Q\+TT@{M\+Q\+TT}!initialize@{initialize}}
\index{initialize@{initialize}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{initialize()}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::initialize (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port,  }\item[{int}]{keepalive,  }\item[{void($\ast$)(char $\ast$, uint8\+\_\+t $\ast$, unsigned int)}]{callback,  }\item[{int}]{maxpacketsize }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 53 of file M\+Q\+T\+T.\+cpp.



References buffer, callback, domain, ip, keepalive, maxpacketsize, String\+::operator=(), port, and qoscallback.



Referenced by M\+Q\+T\+T().


\begin{DoxyCode}
53                                                                                                            
                                          \{
54     this->callback = callback;
55     this->qoscallback = NULL;
56     \textcolor{keywordflow}{if} (ip != NULL)
57         this->ip = ip;
58     \textcolor{keywordflow}{if} (domain != NULL)
59         this->domain = domain;
60     this->port = port;
61     this->keepalive = keepalive;
62 
63     \textcolor{comment}{// if maxpacketsize is over MQTT\_MAX\_PACKET\_SIZE.}
64     this->maxpacketsize = (maxpacketsize <= MQTT_MAX_PACKET_SIZE ? 
      MQTT_MAX_PACKET_SIZE : maxpacketsize);
65     \textcolor{keywordflow}{if} (buffer != NULL)
66       \textcolor{keyword}{delete}[] buffer;
67     buffer = \textcolor{keyword}{new} uint8\_t[this->maxpacketsize];
68 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a57a5231fd3205682c56de70e57dd9d62}} 
\index{M\+Q\+TT@{M\+Q\+TT}!is\+Connected@{is\+Connected}}
\index{is\+Connected@{is\+Connected}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{is\+Connected()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::is\+Connected (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 528 of file M\+Q\+T\+T.\+cpp.



Referenced by connect(), loop(), publish(), publish\+Complete(), publish\+Release(), set\+Broker(), subscribe(), unsubscribe(), and $\sim$\+M\+Q\+T\+T().


\begin{DoxyCode}
528                        \{
529     \textcolor{keywordtype}{bool} rc = (int)_client.connected();
530     \textcolor{keywordflow}{if} (!rc) _client.stop();
531     \textcolor{keywordflow}{return} rc;
532 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a5f9624e440c99d7ec0fb0a8c1a30d064}} 
\index{M\+Q\+TT@{M\+Q\+TT}!loop@{loop}}
\index{loop@{loop}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{loop()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::loop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 240 of file M\+Q\+T\+T.\+cpp.



References buffer, callback, is\+Connected(), keepalive, last\+In\+Activity, last\+Out\+Activity, ping\+Outstanding, publish\+Complete(), publish\+Release(), qoscallback, and read\+Packet().


\begin{DoxyCode}
240                 \{
241     \textcolor{keywordflow}{if} (isConnected()) \{
242         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} t = millis();
243         \textcolor{keywordflow}{if} ((t - lastInActivity > this->keepalive*1000UL) || (t - 
      lastOutActivity > this->keepalive*1000UL)) \{
244             \textcolor{keywordflow}{if} (pingOutstanding) \{
245                 _client.stop();
246                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
247             \} \textcolor{keywordflow}{else} \{
248                 buffer[0] = MQTTPINGREQ;
249                 buffer[1] = 0;
250                 _client.write(buffer,2);
251                 lastOutActivity = t;
252                 lastInActivity = t;
253                 pingOutstanding = \textcolor{keyword}{true};
254             \}
255         \}
256         \textcolor{keywordflow}{if} (_client.available()) \{
257             uint8\_t llen;
258             uint16\_t len = readPacket(&llen);
259             uint16\_t msgId = 0;
260             uint8\_t *payload;
261             \textcolor{keywordflow}{if} (len > 0) \{
262                 lastInActivity = t;
263                 uint8\_t type = buffer[0]&0xF0;
264                 \textcolor{keywordflow}{if} (type == MQTTPUBLISH) \{
265                     \textcolor{keywordflow}{if} (callback) \{
266                         uint16\_t tl = (buffer[llen+1]<<8)+buffer[llen+2]; \textcolor{comment}{// topic length}
267                         \textcolor{keywordtype}{char} topic[tl+1];
268                         \textcolor{keywordflow}{for} (uint16\_t i=0;i<tl;i++) \{
269                             topic[i] = buffer[llen+3+i];
270                         \}
271                         topic[tl] = 0;
272                         \textcolor{comment}{// msgId only present for QOS>0}
273                         \textcolor{keywordflow}{if} ((buffer[0]&0x06) == MQTTQOS1_HEADER_MASK) \{ \textcolor{comment}{// QoS=1}
274                             msgId = (buffer[llen+3+tl]<<8)+buffer[llen+3+tl+1];
275                             payload = buffer+llen+3+tl+2;
276                             callback(topic,payload,len-llen-3-tl-2);
277 
278                             buffer[0] = MQTTPUBACK; \textcolor{comment}{// respond with PUBACK}
279                             buffer[1] = 2;
280                             buffer[2] = (msgId >> 8);
281                             buffer[3] = (msgId & 0xFF);
282                             _client.write(buffer,4);
283                             lastOutActivity = t;
284                                     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((buffer[0] & 0x06) == 
      MQTTQOS2_HEADER_MASK) \{ \textcolor{comment}{// QoS=2}
285                                           msgId = (buffer[llen + 3 + tl] << 8) + 
      buffer[llen + 3 + tl + 1];
286                                           payload = buffer + llen + 3 + tl + 2;
287                                           callback(topic, payload, len - llen - 3 - tl - 2);
288 
289                                         buffer[0] = MQTTPUBREC; \textcolor{comment}{// respond with PUBREC}
290                                         buffer[1] = 2;
291                                         buffer[2] = (msgId >> 8);
292                                         buffer[3] = (msgId & 0xFF);
293                                         _client.write(buffer, 4);
294                                         lastOutActivity = t;
295                                     \} \textcolor{keywordflow}{else} \{
296                             payload = buffer+llen+3+tl;
297                             callback(topic,payload,len-llen-3-tl);
298                         \}
299                     \}
300                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPUBREC) \{
301                     \textcolor{comment}{// check for the situation that QoS2 receive PUBREC, should return PUBREL}
302                     msgId = (buffer[2] << 8) + buffer[3];
303                     this->publishRelease(msgId);
304                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPUBACK) \{
305                     \textcolor{keywordflow}{if} (qoscallback) \{
306                         \textcolor{comment}{// this case QOS==1}
307                         \textcolor{keywordflow}{if} (len == 4 && (buffer[0]&0x06) == MQTTQOS0_HEADER_MASK) \{
308                             msgId = (buffer[2]<<8)+buffer[3];
309                             this->qoscallback(msgId);
310                         \}
311                     \}
312                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPUBREL) \{
313                   msgId = (buffer[2] << 8) + buffer[3];
314                   this->publishComplete(msgId);
315                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPUBCOMP) \{
316                   \textcolor{keywordflow}{if} (qoscallback) \{
317                       \textcolor{comment}{// msgId only present for QOS==0}
318                       \textcolor{keywordflow}{if} (len == 4 && (buffer[0]&0x06) == MQTTQOS0_HEADER_MASK) \{
319                           msgId = (buffer[2]<<8)+buffer[3];
320                           this->qoscallback(msgId);
321                       \}
322                   \}
323                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTSUBACK) \{
324                     \textcolor{comment}{// if something...}
325                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPINGREQ) \{
326                     buffer[0] = MQTTPINGRESP;
327                     buffer[1] = 0;
328                     _client.write(buffer,2);
329                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == MQTTPINGRESP) \{
330                     pingOutstanding = \textcolor{keyword}{false};
331                 \}
332             \}
333         \}
334         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
335     \}
336     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
337 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a0a335a0e6c60ea0e256f76a1969a5137}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [1/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const char $\ast$}]{payload }\end{DoxyParamCaption})}



Definition at line 339 of file M\+Q\+T\+T.\+cpp.



References publish(), and Q\+O\+S0.


\begin{DoxyCode}
339                                                          \{
340     \textcolor{keywordflow}{return} publish(topic, (uint8\_t*)payload, strlen(payload), \textcolor{keyword}{false}, QOS0, NULL);
341 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a802136b5419b3a694ea88be27bdb9043}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [2/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const char $\ast$}]{payload,  }\item[{bool}]{retain }\end{DoxyParamCaption})}



Definition at line 343 of file M\+Q\+T\+T.\+cpp.



References publish(), and Q\+O\+S0.


\begin{DoxyCode}
343                                                                       \{
344     \textcolor{keywordflow}{return} publish(topic, (uint8\_t*)payload, strlen(payload), retain, QOS0, NULL);
345 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ae9321f0f8b365eaf32c87706273cb473}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [3/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const char $\ast$}]{payload,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{uint16\+\_\+t $\ast$}]{messageid = {\ttfamily NULL} }\end{DoxyParamCaption})}



Definition at line 351 of file M\+Q\+T\+T.\+cpp.



References publish().


\begin{DoxyCode}
351                                                                                               \{
352     \textcolor{keywordflow}{return} publish(topic, (uint8\_t*)payload, strlen(payload), \textcolor{keyword}{false}, qos, messageid);
353 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_abd5a453777652cd30ae3cfc4df4aa376}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [4/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const char $\ast$}]{payload,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{bool}]{dup,  }\item[{uint16\+\_\+t $\ast$}]{messageid = {\ttfamily NULL} }\end{DoxyParamCaption})}



Definition at line 347 of file M\+Q\+T\+T.\+cpp.



References publish().


\begin{DoxyCode}
347                                                                                                         \{
348     \textcolor{keywordflow}{return} publish(topic, (uint8\_t*)payload, strlen(payload), \textcolor{keyword}{false}, qos, dup, messageid);
349 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a6a5dd9b7c19f2892802a222ec5d610b5}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [5/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{pyaload,  }\item[{unsigned int}]{plength }\end{DoxyParamCaption})}



Definition at line 355 of file M\+Q\+T\+T.\+cpp.



References publish(), and Q\+O\+S0.


\begin{DoxyCode}
355                                                                                   \{
356     \textcolor{keywordflow}{return} publish(topic, payload, plength, \textcolor{keyword}{false}, QOS0, NULL);
357 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ae9ea303a55434b8a6bba3147938aa9a9}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [6/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{payload,  }\item[{unsigned int}]{plength,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{uint16\+\_\+t $\ast$}]{messageid = {\ttfamily NULL} }\end{DoxyParamCaption})}



Definition at line 363 of file M\+Q\+T\+T.\+cpp.



References publish().


\begin{DoxyCode}
363                                                                                                            
                 \{
364     \textcolor{keywordflow}{return} publish(topic, payload, plength, \textcolor{keyword}{false}, qos, messageid);
365 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a5e7738081e77b6c381f71737e8841869}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [7/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{payload,  }\item[{unsigned int}]{plength,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{bool}]{dup,  }\item[{uint16\+\_\+t $\ast$}]{messageid = {\ttfamily NULL} }\end{DoxyParamCaption})}



Definition at line 359 of file M\+Q\+T\+T.\+cpp.



References publish().


\begin{DoxyCode}
359                                                                                                            
                           \{
360     \textcolor{keywordflow}{return} publish(topic, payload, plength, \textcolor{keyword}{false}, qos, dup, messageid);
361 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ac827a753cde9ed29783dc60092990072}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [8/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{payload,  }\item[{unsigned int}]{plength,  }\item[{bool}]{retain }\end{DoxyParamCaption})}



Definition at line 367 of file M\+Q\+T\+T.\+cpp.



References publish(), and Q\+O\+S0.


\begin{DoxyCode}
367                                                                                                \{
368     \textcolor{keywordflow}{return} publish(topic, payload, plength, retain, QOS0, NULL);
369 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a12d6e2ff5b2aadb36e2fd7abed4fa46b}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [9/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{payload,  }\item[{unsigned int}]{plength,  }\item[{bool}]{retain,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{uint16\+\_\+t $\ast$}]{messageid = {\ttfamily NULL} }\end{DoxyParamCaption})}



Definition at line 371 of file M\+Q\+T\+T.\+cpp.



References publish().



Referenced by publish().


\begin{DoxyCode}
371                                                                                                            
                              \{
372     \textcolor{keywordflow}{return} publish(topic, payload, plength, retain, qos, \textcolor{keyword}{false}, messageid);
373 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a11b8368945d62d46acf4e7d41c57e3c3}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish@{publish}}
\index{publish@{publish}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish()\hspace{0.1cm}{\footnotesize\ttfamily [10/10]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{const uint8\+\_\+t $\ast$}]{payload,  }\item[{unsigned int}]{plength,  }\item[{bool}]{retain,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos,  }\item[{bool}]{dup,  }\item[{uint16\+\_\+t $\ast$}]{messageid }\end{DoxyParamCaption})}



Definition at line 375 of file M\+Q\+T\+T.\+cpp.



References buffer, is\+Connected(), maxpacketsize, next\+Msg\+Id, Q\+O\+S1, Q\+O\+S2, write(), and write\+String().



Referenced by publish().


\begin{DoxyCode}
375                                                                                                            
                                        \{
376     \textcolor{keywordflow}{if} (isConnected()) \{
377         \textcolor{comment}{// Leave room in the buffer for header and variable length field}
378         uint16\_t length = 5;
379         memset(buffer, 0, this->maxpacketsize);
380 
381         length = writeString(topic, buffer, length);
382 
383         \textcolor{keywordflow}{if} (qos == QOS2 || qos == QOS1) \{
384             nextMsgId += 1;
385             buffer[length++] = (nextMsgId >> 8);
386             buffer[length++] = (nextMsgId & 0xFF);
387             \textcolor{keywordflow}{if} (messageid != NULL)
388                 *messageid = nextMsgId++;
389         \}
390 
391         \textcolor{keywordflow}{for} (uint16\_t i=0; i < plength && length < this->maxpacketsize; i++) \{
392             buffer[length++] = payload[i];
393         \}
394 
395         uint8\_t header = MQTTPUBLISH;
396         \textcolor{keywordflow}{if} (retain) \{
397             header |= 1;
398         \}
399 
400         \textcolor{keywordflow}{if} (dup) \{
401             header |= DUP_FLAG_ON_MASK;
402         \}
403 
404         \textcolor{keywordflow}{if} (qos == QOS2)
405             header |= MQTTQOS2_HEADER_MASK;
406         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (qos == QOS1)
407             header |= MQTTQOS1_HEADER_MASK;
408         \textcolor{keywordflow}{else}
409             header |= MQTTQOS0_HEADER_MASK;
410 
411         \textcolor{keywordflow}{return} write(header, buffer, length-5);
412     \}
413     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
414 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a98364d0b5900925a0466b64b84396b18}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish\+Complete@{publish\+Complete}}
\index{publish\+Complete@{publish\+Complete}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish\+Complete()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish\+Complete (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{messageid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 429 of file M\+Q\+T\+T.\+cpp.



References buffer, and is\+Connected().



Referenced by loop().


\begin{DoxyCode}
429                                              \{
430     \textcolor{keywordflow}{if} (isConnected()) \{
431         uint16\_t length = 0;
432         \textcolor{comment}{// reserved bits in MQTT v3.1.1}
433         buffer[length++] = MQTTPUBCOMP | MQTTQOS1_HEADER_MASK;
434         buffer[length++] = 2;
435         buffer[length++] = (messageid >> 8);
436         buffer[length++] = (messageid & 0xFF);
437         \textcolor{keywordflow}{return} _client.write(buffer, length);
438     \}
439     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
440 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a3ec02b7dbe1fbea9f48ee3fc7cb3a9b8}} 
\index{M\+Q\+TT@{M\+Q\+TT}!publish\+Release@{publish\+Release}}
\index{publish\+Release@{publish\+Release}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{publish\+Release()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::publish\+Release (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{messageid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 416 of file M\+Q\+T\+T.\+cpp.



References buffer, and is\+Connected().



Referenced by loop().


\begin{DoxyCode}
416                                             \{
417     \textcolor{keywordflow}{if} (isConnected()) \{
418         uint16\_t length = 0;
419         \textcolor{comment}{// reserved bits in MQTT v3.1.1}
420         buffer[length++] = MQTTPUBREL | MQTTQOS1_HEADER_MASK;
421         buffer[length++] = 2;
422         buffer[length++] = (messageid >> 8);
423         buffer[length++] = (messageid & 0xFF);
424         \textcolor{keywordflow}{return} _client.write(buffer, length);
425     \}
426     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
427 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_aad0854b6a156344e03926ab53f15adbd}} 
\index{M\+Q\+TT@{M\+Q\+TT}!read\+Byte@{read\+Byte}}
\index{read\+Byte@{read\+Byte}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{read\+Byte()}
{\footnotesize\ttfamily uint8\+\_\+t M\+Q\+T\+T\+::read\+Byte (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 190 of file M\+Q\+T\+T.\+cpp.



Referenced by read\+Packet().


\begin{DoxyCode}
190                        \{
191     \textcolor{keywordflow}{while}(!_client.available()) \{\}
192     \textcolor{keywordflow}{return} _client.read();
193 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a78d0e70a566c983f13b002b88c467267}} 
\index{M\+Q\+TT@{M\+Q\+TT}!read\+Packet@{read\+Packet}}
\index{read\+Packet@{read\+Packet}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{read\+Packet()}
{\footnotesize\ttfamily uint16\+\_\+t M\+Q\+T\+T\+::read\+Packet (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{length\+Length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 195 of file M\+Q\+T\+T.\+cpp.



References buffer, maxpacketsize, and read\+Byte().



Referenced by connect(), and loop().


\begin{DoxyCode}
195                                                \{
196     uint16\_t len = 0;
197     buffer[len++] = readByte();
198     \textcolor{keywordtype}{bool} isPublish = (buffer[0]&0xF0) == MQTTPUBLISH;
199     uint32\_t multiplier = 1;
200     uint16\_t length = 0;
201     uint8\_t digit = 0;
202     uint16\_t skip = 0;
203     uint8\_t start = 0;
204 
205     \textcolor{keywordflow}{do} \{
206         digit = readByte();
207         buffer[len++] = digit;
208         length += (digit & 127) * multiplier;
209         multiplier *= 128;
210     \} \textcolor{keywordflow}{while} ((digit & 128) != 0);
211     *lengthLength = len-1;
212 
213     \textcolor{keywordflow}{if} (isPublish) \{
214         \textcolor{comment}{// Read in topic length to calculate bytes to skip over for Stream writing}
215         buffer[len++] = readByte();
216         buffer[len++] = readByte();
217         skip = (buffer[*lengthLength+1]<<8)+buffer[*lengthLength+2];
218         start = 2;
219         \textcolor{keywordflow}{if} (buffer[0] & MQTTQOS1_HEADER_MASK) \{
220             \textcolor{comment}{// skip message id}
221             skip += 2;
222         \}
223     \}
224 
225     \textcolor{keywordflow}{for} (uint16\_t i = start;i<length;i++) \{
226         digit = readByte();
227         \textcolor{keywordflow}{if} (len < this->maxpacketsize) \{
228             buffer[len] = digit;
229         \}
230         len++;
231     \}
232 
233     \textcolor{keywordflow}{if} (len > this->maxpacketsize) \{
234         len = 0; \textcolor{comment}{// This will cause the packet to be ignored.}
235     \}
236 
237     \textcolor{keywordflow}{return} len;
238 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a07b3b97bcf999a2d0a292bca4f29bbc7}} 
\index{M\+Q\+TT@{M\+Q\+TT}!set\+Broker@{set\+Broker}}
\index{set\+Broker@{set\+Broker}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{set\+Broker()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::set\+Broker (\begin{DoxyParamCaption}\item[{char $\ast$}]{domain,  }\item[{uint16\+\_\+t}]{port }\end{DoxyParamCaption})}



Definition at line 70 of file M\+Q\+T\+T.\+cpp.



References disconnect(), domain, ip, is\+Connected(), String\+::operator=(), and port.


\begin{DoxyCode}
70                                                 \{
71     \textcolor{keywordflow}{if}(isConnected()) \{
72         disconnect();
73     \}
74     this->domain = domain;
75     this->ip = NULL;
76     this->port = port;
77 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ad17765f1a34eacf2f0a3b384181a7129}} 
\index{M\+Q\+TT@{M\+Q\+TT}!set\+Broker@{set\+Broker}}
\index{set\+Broker@{set\+Broker}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{set\+Broker()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void M\+Q\+T\+T\+::set\+Broker (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{ip,  }\item[{uint16\+\_\+t}]{port }\end{DoxyParamCaption})}



Definition at line 79 of file M\+Q\+T\+T.\+cpp.



References disconnect(), domain, ip, is\+Connected(), String\+::operator=(), and port.


\begin{DoxyCode}
79                                                \{
80     \textcolor{keywordflow}{if}(isConnected()) \{
81         disconnect();
82     \}
83     this->domain = \textcolor{stringliteral}{""};
84     this->ip = ip;
85     this->port = port;
86 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_aad37921199d922122e1d390883ab6591}} 
\index{M\+Q\+TT@{M\+Q\+TT}!subscribe@{subscribe}}
\index{subscribe@{subscribe}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{subscribe()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::subscribe (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic }\end{DoxyParamCaption})}



Definition at line 469 of file M\+Q\+T\+T.\+cpp.



References Q\+O\+S0, and subscribe().


\begin{DoxyCode}
469                                       \{
470     \textcolor{keywordflow}{return} subscribe(topic, QOS0);
471 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ac619e73524dcc0aa2c70ae160d7b6689}} 
\index{M\+Q\+TT@{M\+Q\+TT}!subscribe@{subscribe}}
\index{subscribe@{subscribe}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{subscribe()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::subscribe (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic,  }\item[{\textbf{ E\+M\+Q\+T\+T\+\_\+\+Q\+OS}}]{qos }\end{DoxyParamCaption})}



Definition at line 473 of file M\+Q\+T\+T.\+cpp.



References buffer, is\+Connected(), next\+Msg\+Id, write(), and write\+String().



Referenced by subscribe().


\begin{DoxyCode}
473                                                      \{
474 
475     \textcolor{keywordflow}{if} (isConnected()) \{
476         \textcolor{comment}{// Leave room in the buffer for header and variable length field}
477         uint16\_t length = 5;
478         nextMsgId++;
479         \textcolor{keywordflow}{if} (nextMsgId == 0) \{
480             nextMsgId = 1;
481         \}
482         buffer[length++] = (nextMsgId >> 8);
483         buffer[length++] = (nextMsgId & 0xFF);
484         length = writeString(topic, buffer,length);
485         buffer[length++] = qos;
486         \textcolor{keywordflow}{return} write(MQTTSUBSCRIBE | MQTTQOS1_HEADER_MASK,buffer,length-5);
487     \}
488     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
489 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a70bfce6554c3d08f7a0e174d23a8b642}} 
\index{M\+Q\+TT@{M\+Q\+TT}!unsubscribe@{unsubscribe}}
\index{unsubscribe@{unsubscribe}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{unsubscribe()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::unsubscribe (\begin{DoxyParamCaption}\item[{const char $\ast$}]{topic }\end{DoxyParamCaption})}



Definition at line 491 of file M\+Q\+T\+T.\+cpp.



References buffer, is\+Connected(), next\+Msg\+Id, write(), and write\+String().


\begin{DoxyCode}
491                                         \{
492     \textcolor{keywordflow}{if} (isConnected()) \{
493         uint16\_t length = 5;
494         nextMsgId++;
495         \textcolor{keywordflow}{if} (nextMsgId == 0) \{
496             nextMsgId = 1;
497         \}
498         buffer[length++] = (nextMsgId >> 8);
499         buffer[length++] = (nextMsgId & 0xFF);
500         length = writeString(topic, buffer,length);
501         \textcolor{keywordflow}{return} write(MQTTUNSUBSCRIBE | MQTTQOS1_HEADER_MASK,buffer,length-5);
502     \}
503     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
504 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_a19b7d1a9fae7e5176469c167a6919060}} 
\index{M\+Q\+TT@{M\+Q\+TT}!write@{write}}
\index{write@{write}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{write()}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{header,  }\item[{uint8\+\_\+t $\ast$}]{buf,  }\item[{uint16\+\_\+t}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 442 of file M\+Q\+T\+T.\+cpp.



Referenced by connect(), publish(), subscribe(), and unsubscribe().


\begin{DoxyCode}
442                                                               \{
443     uint8\_t lenBuf[4];
444     uint8\_t llen = 0;
445     uint8\_t digit;
446     uint8\_t pos = 0;
447     uint16\_t rc;
448     uint16\_t len = length;
449     \textcolor{keywordflow}{do} \{
450         digit = len % 128;
451         len = len / 128;
452         \textcolor{keywordflow}{if} (len > 0) \{
453             digit |= 0x80;
454         \}
455         lenBuf[pos++] = digit;
456         llen++;
457     \} \textcolor{keywordflow}{while}(len > 0);
458 
459     buf[4-llen] = header;
460     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < llen; i++) \{
461         buf[5-llen+i] = lenBuf[i];
462     \}
463     rc = _client.write(buf+(4-llen), length+1+llen);
464 
465     lastOutActivity = millis();
466     \textcolor{keywordflow}{return} (rc == 1+llen+length);
467 \}
\end{DoxyCode}
\mbox{\label{class_m_q_t_t_ae75a977549b28466d0a40cdf90e49c01}} 
\index{M\+Q\+TT@{M\+Q\+TT}!write\+String@{write\+String}}
\index{write\+String@{write\+String}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{write\+String()}
{\footnotesize\ttfamily uint16\+\_\+t M\+Q\+T\+T\+::write\+String (\begin{DoxyParamCaption}\item[{const char $\ast$}]{string,  }\item[{uint8\+\_\+t $\ast$}]{buf,  }\item[{uint16\+\_\+t}]{pos }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 514 of file M\+Q\+T\+T.\+cpp.



References maxpacketsize.



Referenced by connect(), publish(), subscribe(), and unsubscribe().


\begin{DoxyCode}
514                                                                          \{
515     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* idp = string;
516     uint16\_t i = 0;
517     pos += 2;
518     \textcolor{keywordflow}{while} (*idp && pos < this->maxpacketsize) \{
519         buf[pos++] = *idp++;
520         i++;
521     \}
522     buf[pos-i-2] = (i >> 8);
523     buf[pos-i-1] = (i & 0xFF);
524     \textcolor{keywordflow}{return} pos;
525 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\label{class_m_q_t_t_a0180f906b9bbff0f2845900df0e5475d}} 
\index{M\+Q\+TT@{M\+Q\+TT}!\+\_\+client@{\+\_\+client}}
\index{\+\_\+client@{\+\_\+client}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{\+\_\+client}
{\footnotesize\ttfamily T\+C\+P\+Client M\+Q\+T\+T\+::\+\_\+client\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 129 of file M\+Q\+T\+T.\+h.

\mbox{\label{class_m_q_t_t_a1d884782e6eec91dabe49b0bb4360a39}} 
\index{M\+Q\+TT@{M\+Q\+TT}!buffer@{buffer}}
\index{buffer@{buffer}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{buffer}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ M\+Q\+T\+T\+::buffer = N\+U\+LL\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 130 of file M\+Q\+T\+T.\+h.



Referenced by connect(), disconnect(), initialize(), loop(), publish(), publish\+Complete(), publish\+Release(), read\+Packet(), subscribe(), unsubscribe(), and $\sim$\+M\+Q\+T\+T().

\mbox{\label{class_m_q_t_t_ad40d1645b7ec6c7b969883825f0c0469}} 
\index{M\+Q\+TT@{M\+Q\+TT}!callback@{callback}}
\index{callback@{callback}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{callback}
{\footnotesize\ttfamily void($\ast$ M\+Q\+T\+T\+::callback) (char $\ast$, uint8\+\_\+t $\ast$, unsigned int)\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 135 of file M\+Q\+T\+T.\+h.



Referenced by initialize(), and loop().

\mbox{\label{class_m_q_t_t_a36cef0e2c168c4ce68dda653df6e3be1}} 
\index{M\+Q\+TT@{M\+Q\+TT}!domain@{domain}}
\index{domain@{domain}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{domain}
{\footnotesize\ttfamily \textbf{ String} M\+Q\+T\+T\+::domain\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 141 of file M\+Q\+T\+T.\+h.



Referenced by initialize(), and set\+Broker().

\mbox{\label{class_m_q_t_t_a70618323bb75b467ed054dd191397b37}} 
\index{M\+Q\+TT@{M\+Q\+TT}!ip@{ip}}
\index{ip@{ip}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{ip}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ M\+Q\+T\+T\+::ip = N\+U\+LL\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 142 of file M\+Q\+T\+T.\+h.



Referenced by initialize(), and set\+Broker().

\mbox{\label{class_m_q_t_t_af93aeb459130c36b2a8d894011f10492}} 
\index{M\+Q\+TT@{M\+Q\+TT}!keepalive@{keepalive}}
\index{keepalive@{keepalive}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{keepalive}
{\footnotesize\ttfamily int M\+Q\+T\+T\+::keepalive\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 144 of file M\+Q\+T\+T.\+h.



Referenced by connect(), initialize(), and loop().

\mbox{\label{class_m_q_t_t_a0a5d8f29e0e75772e0a85b109fa77a04}} 
\index{M\+Q\+TT@{M\+Q\+TT}!last\+In\+Activity@{last\+In\+Activity}}
\index{last\+In\+Activity@{last\+In\+Activity}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{last\+In\+Activity}
{\footnotesize\ttfamily unsigned long M\+Q\+T\+T\+::last\+In\+Activity\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 133 of file M\+Q\+T\+T.\+h.



Referenced by loop().

\mbox{\label{class_m_q_t_t_a58a1c0a26b1de2522b79627b224bf1f6}} 
\index{M\+Q\+TT@{M\+Q\+TT}!last\+Out\+Activity@{last\+Out\+Activity}}
\index{last\+Out\+Activity@{last\+Out\+Activity}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{last\+Out\+Activity}
{\footnotesize\ttfamily unsigned long M\+Q\+T\+T\+::last\+Out\+Activity\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 132 of file M\+Q\+T\+T.\+h.



Referenced by loop().

\mbox{\label{class_m_q_t_t_aac8cf32807b542ce45a9060d9769f35e}} 
\index{M\+Q\+TT@{M\+Q\+TT}!maxpacketsize@{maxpacketsize}}
\index{maxpacketsize@{maxpacketsize}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{maxpacketsize}
{\footnotesize\ttfamily uint16\+\_\+t M\+Q\+T\+T\+::maxpacketsize\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 145 of file M\+Q\+T\+T.\+h.



Referenced by initialize(), publish(), read\+Packet(), and write\+String().

\mbox{\label{class_m_q_t_t_ade1e9fc252b7ca59f30be31439ff84ab}} 
\index{M\+Q\+TT@{M\+Q\+TT}!next\+Msg\+Id@{next\+Msg\+Id}}
\index{next\+Msg\+Id@{next\+Msg\+Id}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{next\+Msg\+Id}
{\footnotesize\ttfamily uint16\+\_\+t M\+Q\+T\+T\+::next\+Msg\+Id\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 131 of file M\+Q\+T\+T.\+h.



Referenced by connect(), publish(), subscribe(), and unsubscribe().

\mbox{\label{class_m_q_t_t_ac02a4988506ab78812a1a9cc91be9007}} 
\index{M\+Q\+TT@{M\+Q\+TT}!ping\+Outstanding@{ping\+Outstanding}}
\index{ping\+Outstanding@{ping\+Outstanding}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{ping\+Outstanding}
{\footnotesize\ttfamily bool M\+Q\+T\+T\+::ping\+Outstanding\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 134 of file M\+Q\+T\+T.\+h.



Referenced by connect(), and loop().

\mbox{\label{class_m_q_t_t_a27559174e21256b6235ff281ba605fe8}} 
\index{M\+Q\+TT@{M\+Q\+TT}!port@{port}}
\index{port@{port}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{port}
{\footnotesize\ttfamily uint16\+\_\+t M\+Q\+T\+T\+::port\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 143 of file M\+Q\+T\+T.\+h.



Referenced by initialize(), and set\+Broker().

\mbox{\label{class_m_q_t_t_a3b5999625aa19e5198896195b5b5149c}} 
\index{M\+Q\+TT@{M\+Q\+TT}!qoscallback@{qoscallback}}
\index{qoscallback@{qoscallback}!M\+Q\+TT@{M\+Q\+TT}}
\subsubsection{qoscallback}
{\footnotesize\ttfamily void($\ast$ M\+Q\+T\+T\+::qoscallback) (unsigned int)\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 136 of file M\+Q\+T\+T.\+h.



Referenced by add\+Qos\+Callback(), initialize(), and loop().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/\+M\+Q\+T\+T/src/\textbf{ M\+Q\+T\+T.\+h}\item 
lib/\+M\+Q\+T\+T/src/\textbf{ M\+Q\+T\+T.\+cpp}\end{DoxyCompactItemize}
